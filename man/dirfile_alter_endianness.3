.\" dirfile_alter_endianness.3.  The dirfile_alter_endianness man page.
.\"
.\" (C) 2008 D. V. Wiebe
.\"
.\""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
.\"
.\" This file is part of the GetData project.
.\"
.\" This program is free software; you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License as published by
.\" the Free Software Foundation; either version 2 of the License, or
.\" (at your option) any later version.
.\"
.\" GetData is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
.\" General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public License along
.\" with GetData; if not, write to the Free Software Foundation, Inc.,
.\" 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
.\"
.TH dirfile_alter_endianness 3 "8 December 2008" "Version 0.5.0" "GETDATA"
.SH NAME
dirfile_alter_endianness \(em modify the byte sex of fields in a dirfile
.SH SYNOPSIS
.B #include <getdata.h>
.HP
.nh
.ad l
.BI "int dirfile_alter_endianness(DIRFILE *" dirfile ", unsigned int " offset ,
.BI "int " fragment_index ", int " move );
.hy
.ad n
.SH DESCRIPTION
The
.BR dirfile_alter_endianness ()
function sets the byte sex of the format file fragment specified by
.I fragment_index
to
.I byte_sex
in the dirfile(5) database specified by
.IR dirfile .
The byte sex of a fragment indicate the endianness of data stored in binary
files associated with
.B RAW
fields defined in the specified fragment.  The byte sex of a fragment containing
no
.B RAW
fields is ignored.

The
.I byte_sex
argument should be one of the following:
.TP
.BR 0 " (zero)"
Indicates the byte sex should be the native endianness of the host, whichever
that may be.
.TP
.B GD_BIG_ENDIAN
Indicates the byte sex should be big endian.
.TP
.B GD_LITTLE_ENDIAN
Indicates the byte sex should be little endian.
.TP
.RB ( GD_BIG_ENDIAN " | " GD_LITTLE_ENDIAN )
Indicates the byte sex should be the opposite of the native endianness of the
host, whichever that may be.
.P
In addition to being simply a valid fragment index,
.I fragment_index
may also be the special value
.BR GD_ALL_FRAGMENTS ,
which indicates that the frame offset of all fragments in the database should
be changed.

If the
.I move
argument is non-zero, this call will byte swap the binary data of affected
.B RAW
fields to account for the change in byte sex.  If the encoding of the
fragment is endianness insensitive, or if the data type is only one byte in
size, no change is made.  If
.I move
is zero, affected binary files are left untouched.

.SH RETURN VALUE
Upon successful completion,
.BR dirfile_alter_endianness ()
returns zero.  On error, it returns -1 and sets the dirfile error to a non-zero
error value.  Possible error values are:
.TP 8
.B GD_E_ACCMODE
The specified dirfile was opened read-only.
.TP
.B GD_E_ALLOC
The library was unable to allocate memory.
.TP
.B GD_E_BAD_DIRFILE
The supplied dirfile was invalid.
.TP
.B GD_E_BAD_INDEX
The supplied index was out of range.
.TP
.B GD_E_PROTECTED
The metadata of the specified format file fragment was protected from change,
or the binary data of the fragment was protected from change and binary file
byte swapping was requested.
.TP
.B GD_E_RAW_IO
An I/O error occurred while attempting to byte swap a binary file.
.TP
.B GD_E_UNKNOWN_ENCODING
The encoding scheme of the fragment is unknown.
.TP
.B GD_E_UNSUPPORTED
The encoding scheme of the fragment does not suport binary file byte swapping.
.P
The dirfile error may be retrieved by calling
.BR get_error (3).
A descriptive error string for the last error encountered can be obtained from
a call to
.BR get_error_string (3).
.SH NOTES
A binary file byte swap occurs out-of-place.  As a result, sufficient space
must be present on the filesystem for the binary files of all
.B RAW
fields in the fragment both before and after translation.  If all fragments
are updated by specifying
.BR GD_ALL_FRAGMENTS ,
the byte swapping occurs one fragment at a time.
.SH SEE ALSO
.BR dirfile_open (3),
.BR getdata (3),
.BR get_endianess (3),
.BR get_error (3),
.BR get_error_string (3),
.BR dirfile (5),
.BR dirfile-format (5)
